## âœ… ë°±íŠ¸ë˜í‚¹(Backtracking)

---

ë°±íŠ¸ë˜í‚¹ì€
 **í•´ë¥¼ ì°¾ê¸° ìœ„í•´ ëª¨ë“  ê°€ëŠ¥í•œ ê²½ìš°ì˜ ìˆ˜ë¥¼ íƒìƒ‰í•˜ë˜, íƒìƒ‰ ê³¼ì •ì—ì„œ ìœ ë§í•˜ì§€ ì•Šì€ ê²½ìš°(í•´ê°€ ë  ìˆ˜ ì—†ëŠ” ê²½ìš°)ëŠ” ë” ì´ìƒ ì§„í–‰í•˜ì§€ ì•Šê³  ë˜ëŒì•„ê°€ ë‹¤ë¥¸ ê²½ë¡œë¥¼ ì‹œë„í•˜ëŠ” ê¸°ë²•**ì´ë‹¤.

------

## í•µì‹¬ í¬ì¸íŠ¸

1. **íƒìƒ‰ + ë˜ëŒì•„ê°€ê¸°**
   - ì–´ë–¤ ì„ íƒì„ í–ˆë‹¤ê°€, ë” ì´ìƒ ì§„í–‰í•  ìˆ˜ ì—†ê±°ë‚˜ ëª©ì ì„ ë‹¬ì„±í•˜ì§€ ëª»í•˜ë©´ ê·¸ ì„ íƒì„ ì·¨ì†Œ(undo)í•˜ê³  ì§ì „ ìƒíƒœë¡œ ëŒì•„ê°.
2. **ì¬ê·€(DFS)ì™€ í•¨ê»˜ ìì£¼ ì‚¬ìš©**
   - ë³´í†µ DFSì™€ ê²°í•©ë˜ì–´, íƒìƒ‰í•˜ë©´ì„œ `visited`, `path` ê°™ì€ ìƒíƒœë¥¼ ê¸°ë¡í–ˆë‹¤ê°€ ë˜ëŒë¦¬ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ë¨.
3. **íš¨ìœ¨ì„±**
   - ë‹¨ìˆœí•œ brute force(ëª¨ë“  ê²½ìš° ë‹¤ ì‹œë„)ì™€ ë‹¬ë¦¬, **ë¶ˆí•„ìš”í•œ ê²½ë¡œëŠ” ì¡°ê¸°ì— ì˜ë¼ë‚´ì–´ íƒìƒ‰ëŸ‰ì„ ì¤„ì´ëŠ” ê²ƒ**ì´ íŠ¹ì§•.

------

## ëŒ€í‘œ ì˜ˆì‹œ ë¬¸ì œ

- **N-Queens ë¬¸ì œ**: ì²´ìŠ¤íŒì— í€¸ì„ ë†“ì„ ë•Œ, ë¶ˆê°€ëŠ¥í•œ ë°°ì¹˜ë¼ë©´ ë” íƒìƒ‰í•˜ì§€ ì•Šê³  ë°”ë¡œ ë˜ëŒì•„ê°.
- **ë¯¸ë¡œ ì°¾ê¸°**: ë§‰íŒ ê¸¸ì„ ë§Œë‚˜ë©´ ë˜ëŒì•„ê°€ ë‹¤ë¥¸ ê¸¸ íƒìƒ‰.
- **ë¶€ë¶„ì§‘í•©/ìˆœì—´ ìƒì„±**: íŠ¹ì • ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ê²½ìš°ëŠ” ë” ê¹Šì´ ê°€ì§€ ì•Šê³  ë˜ëŒì•„ê°.

------

ğŸ“Œ í•œ ì¤„ ìš”ì•½:
 **ë°±íŠ¸ë˜í‚¹ì€ â€œê°€ëŠ¥í•œ í•´ë¥¼ ì°¾ëŠ” ê³¼ì •ì—ì„œ, í•´ê°€ ë  ìˆ˜ ì—†ëŠ” ê²½ë¡œëŠ” ì¦‰ì‹œ ë˜ëŒì•„ê°€ë©° íƒìƒ‰í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ê¸°ë²•â€ì´ë‹¤.**



---

## ğŸ“Š DFS ë‹¨ìˆœ íƒìƒ‰ vs ë°±íŠ¸ë˜í‚¹ íƒìƒ‰

| êµ¬ë¶„             | DFS ë‹¨ìˆœ íƒìƒ‰                                    | DFS + ë°±íŠ¸ë˜í‚¹ íƒìƒ‰                                 |
| ---------------- | ------------------------------------------------ | --------------------------------------------------- |
| **ëª©ì **         | í•œ ë²ˆ ë°©ë¬¸í•œ ë…¸ë“œëŠ” ë‹¤ì‹œ ë°©ë¬¸í•˜ì§€ ì•Šê³  ê²½ë¡œ íƒìƒ‰ | ëª¨ë“  ê°€ëŠ¥í•œ ê²½ë¡œ íƒìƒ‰ + ë¶ˆê°€ëŠ¥í•œ ê²½ë¡œëŠ” ì¡°ê¸°ì— í¬ê¸° |
| **visited ì²˜ë¦¬** | ë°©ë¬¸í•œ ë…¸ë“œëŠ” ëê¹Œì§€ ìœ ì§€ (`remove` ì•ˆ í•¨)       | íƒìƒ‰ì´ ëë‚˜ë©´ ë°©ë¬¸ ê¸°ë¡ì„ ë˜ëŒë¦¼ (`remove`)         |
| **ê²½ë¡œ ê´€ë¦¬**    | ê²½ë¡œë¥¼ í•œ ë²ˆë§Œ ê¸°ë¡                              | ê²½ë¡œì— ì¶”ê°€ â†’ íƒìƒ‰ ëë‚˜ë©´ ì œê±° (ë³µì›)               |
| **íƒìƒ‰ ê²°ê³¼**    | íŠ¹ì • ê²½ë¡œ í•˜ë‚˜(ë˜ëŠ” ë„ë‹¬ ì—¬ë¶€) í™•ì¸              | ê°€ëŠ¥í•œ ëª¨ë“  ê²½ë¡œÂ·ì¡°í•©Â·ë°°ì¹˜ íƒìƒ‰                     |
| **í™œìš© ì˜ˆì‹œ**    | ê·¸ë˜í”„ ì—°ê²° ì—¬ë¶€ í™•ì¸, ìµœë‹¨ ê±°ë¦¬ BFS ëŒ€ì²´        | N-Queens, ë¯¸ë¡œ ì°¾ê¸°, ìˆœì—´Â·ì¡°í•© ìƒì„±                 |
| **ë¹„ìœ **         | â€œí•œ ë²ˆ ê°„ ê¸¸ì€ ë‹¤ì‹œ ì•ˆ ê°„ë‹¤â€                     | â€œê¸¸ì„ ê°€ë‹¤ê°€ ë§‰íˆë©´ ëŒì•„ì™€ì„œ ë‹¤ë¥¸ ê¸¸ì„ ë‹¤ì‹œ ê°„ë‹¤â€   |

------



ì˜ˆì‹œ ê·¸ë˜í”„ 1 

```txt
1
â”œâ”€ 2
â””â”€ 3
```



## 1ï¸âƒ£ DFS ë‹¨ìˆœ íƒìƒ‰ (visitedë§Œ ìœ ì§€)

```python
def dfs_simple(x, visited, path):
    visited.add(x)
    path.append(x)

    for nxt in graph[x]:
        if nxt not in visited:
            dfs_simple(nxt, visited, path)

    # âŒ visitedì™€ pathë¥¼ ë³µì›í•˜ì§€ ì•ŠìŒ
    # í•œ ë²ˆ ì§€ë‚˜ê°„ ë…¸ë“œëŠ” ë‹¤ë¥¸ ê²½ë¡œì—ì„œ ëª» ì”€

graph = {1:[2,3], 2:[], 3:[]}
dfs_simple(1, set(), [])
# ê²°ê³¼: 1 â†’ 2 ë§Œ íƒìƒ‰, 1 â†’ 3 ì€ ëª» íƒìƒ‰
```

------



## 2ï¸âƒ£ DFS + ë°±íŠ¸ë˜í‚¹ (ë˜ëŒë¦¬ê¸°)

í•µì‹¬ì€ **ìê¸° ì¬ê·€ í˜¸ì¶œ(ìŠ¤íƒ í”„ë ˆì„)ì´ ëë‚  ë•Œ**, ì¦‰ **ìì‹ ì´ ë§¡ì€ ëª¨ë“  ìì‹ íƒìƒ‰ì´ ëë‚œ ì§í›„**ì— `visited.remove(x)`ì™€ `path.pop()`ì´ ì‹¤í–‰ëœë‹¤ëŠ” ì ì´ì•¼. ê·¸ë˜ì„œ ì´ ë‘ ì¤„ì€ **í•¨ìˆ˜ì˜ â€œí‡´ì¥ í›…(post-order)â€** ê°™ì€ ê±°ë¼ê³  ë³´ë©´ ë¼.

```python
def dfs_backtracking(x, visited, path):
    visited.add(x)
    path.append(x)

    for nxt in graph[x]:
        if nxt not in visited:
            dfs_backtracking(nxt, visited, path)

    # âœ… íƒìƒ‰ ëë‚œ í›„ ë˜ëŒë¦¬ê¸°
    visited.remove(x)
    path.pop()
    '''ì™œ ì´ ì‹œì ì—ì„œ ë˜ëŒë¦¬ëŠ” ê±°ëƒë©´, '''

graph = {1:[2,3], 2:[], 3:[]}
dfs_backtracking(1, set(), [])
# ê²°ê³¼: 1 â†’ 2, 1 â†’ 3 ë‘ ê²½ë¡œ ëª¨ë‘ íƒìƒ‰
```

** ì°¸ê³ , ì™œ ë£¨í”„ ë°”ê¹¥ì—ì„œ ì§€ìš¸ê¹Œ?

```python
def dfs_backtracking(x, visited, path):
    visited.add(x)      # [ì…ì¥] x ë°©ë¬¸í‘œì‹œ
    path.append(x)      # [ì…ì¥] ê²½ë¡œì— x ê¸°ë¡

    for nxt in graph[x]:
        if nxt not in visited:
            dfs_backtracking(nxt, visited, path)  # ìì‹ì—ê²Œ ë§¡ê¹€
            # (ì—¬ê¸° ì‹œì ì—ì„œëŠ” "nxtê°€ ìŠ¤ìŠ¤ë¡œ" visited/pathë¥¼ ë˜ëŒë¦¬ê³  ë°˜í™˜í•¨)

    visited.remove(x)   # [í‡´ì¥] xì— ëŒ€í•œ ëª¨ë“  ìì‹ íƒìƒ‰ ë â†’ x í”ì  ì œê±°
    path.pop()          # [í‡´ì¥] ê²½ë¡œì—ì„œ x ì œê±°
```

- ê° **ìì‹ í˜¸ì¶œ**ì€ **ìê¸° ìì‹ **ì„ ë“¤ì–´ê°ˆ ë•Œ add/append í•˜ê³ , **ìê¸° ìì‹ **ì´ ëë‚  ë•Œ remove/pop í•´.
- ê·¸ëŸ¬ê³  ë¶€ëª¨ë¡œ ëŒì•„ì˜¤ë©´, ë¶€ëª¨ëŠ” **ì—¬ì „íˆ xê°€ ë°©ë¬¸ ì¤‘(visitedì— ìˆìŒ)**ì¸ ìƒíƒœì—ì„œ ë‹¤ìŒ í˜•ì œ `nxt`ë¥¼ ë³¸ë‹¤.
  - ì´ê²ƒì´ ì•ˆì „í•œ ì´ìœ : **ì•„ë˜ë¡œ ë‚´ë ¤ê°„ ì¬ê·€ê°€ ë¶€ëª¨(x)ë¥¼ ë‹¤ì‹œ ë°ŸëŠ” ê²ƒì„ ë°©ì§€**í•˜ë ¤ë©´, ë¶€ëª¨ê°€ íƒìƒ‰ ì¤‘ì—ëŠ” `visited`ì— **ë‚¨ì•„ ìˆì–´ì•¼** í•´.
- ë¶€ëª¨ì˜ **ëª¨ë“  ìì‹**ì„ ëê¹Œì§€ ì²˜ë¦¬í•˜ê³  ë‚˜ì„œì•¼, ë¹„ë¡œì†Œ **ë¶€ëª¨ ìì‹ (x)** ì„ ì§€ì›Œë„ ë¼.
   â†’ ê·¸ë˜ì„œ `visited.remove(x)`/`path.pop()`ì´ **for ë£¨í”„ ë°”ê¹¥(ëë‚œ ë’¤)**ì— ìˆë‹¤.

> ë§Œì•½ `visited.remove(x)`ë¥¼ ë£¨í”„ ì•ˆ(ìì‹ í•˜ë‚˜ ëë‚  ë•Œë§ˆë‹¤)ì—ì„œ í•´ë²„ë¦¬ë©´,
>  ì•„ì§ ë‹¤ë¥¸ ìì‹(ë‹¤ë¥¸ `nxt`)ë„ ë‚¨ì•˜ëŠ”ë° **ë¶€ëª¨ xê°€ ë¯¸ë°©ë¬¸ ìƒíƒœë¡œ ë°”ë€Œì–´** ì•„ë˜ ë‹¨ê³„ì—ì„œ xë¡œ **ì—­íšŒê·€(ì‚¬ì´í´)**ê°€ ìƒê¸¸ ìˆ˜ ìˆì–´.
>  ì¦‰, **ë¶€ëª¨ëŠ” ëª¨ë“  ìì‹ ì²˜ë¦¬ê°€ ëë‚  ë•Œ** ë‚´ë ¤ë†“ëŠ” ê²Œ ë§ë‹¤.

---



## ë‹¤ì´ì•„ëª¬ë“œ ê·¸ë˜í”„ì—ì„œ ì°¨ì´ í™•ì¸

```
1
â”œâ”€ 2
â””â”€ 3
 \ /
  4   (goal)
```

- ë‹¨ìˆœ DFS(ì „ì—­ visited ìœ ì§€, ë³µì› X): `4`ë¥¼ í•œ ë²ˆ ë°©ë¬¸í•˜ê³  ë‚˜ë©´ **ë‹¤ë¥¸ ê²½ë¡œì˜ 4**ë¡œëŠ” ëª» ê° â†’ **ê²½ë¡œ í•˜ë‚˜ë§Œ** ë‚˜ì˜´
- ë°±íŠ¸ë˜í‚¹(visited ë³µì›): `4` ì¬ì‚¬ìš© ê°€ëŠ¥(ê²½ë¡œë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ë°©ë¬¸) â†’ **ëª¨ë“  ê²½ë¡œ**ê°€ ë‚˜ì˜´

```python
graph = {1:[2,3], 2:[4], 3:[4], 4:[]}
start, goal = 1, 4

# 1) ë‹¨ìˆœ DFS: visited ë³µì› ì—†ìŒ â†’ ê²½ë¡œ ì¼ë¶€ ëˆ„ë½
def dfs_simple(u, goal, visited, path):
    visited.add(u)
    path.append(u)
    if u == goal:
        print("[ë‹¨ìˆœDFS] ê²½ë¡œ:", path)
        return
    for v in graph[u]:
        if v not in visited:
            # pathëŠ” ë³µì› ì•ˆ í•˜ë¯€ë¡œ, ì•ˆì „í•˜ê²Œ ë³µì‚¬í•´ì„œ ë‚´ë ¤ê°(ì‹¤í–‰ ì˜¤ë¥˜ ë°©ì§€ìš©)
            dfs_simple(v, goal, visited, path[:])

# 2) ë°±íŠ¸ë˜í‚¹ DFS: visited/path ë³µì› â†’ ëª¨ë“  ê²½ë¡œ ì¶œë ¥
def dfs_backtrack(u, goal, visited, path):
    visited.add(u)
    path.append(u)
    if u == goal:
        print("[ë°±íŠ¸ë˜í‚¹] ê²½ë¡œ:", path)
    else:
        for v in graph[u]:
            if v not in visited:
                dfs_backtrack(v, goal, visited, path)
    # ë˜ëŒë¦¬ê¸°(í•µì‹¬)
    visited.remove(u)
    path.pop()

print("=== ë‹¨ìˆœ DFS ê²°ê³¼ ===")
dfs_simple(start, goal, set(), [])

print("\n=== ë°±íŠ¸ë˜í‚¹ DFS ê²°ê³¼ ===")
dfs_backtrack(start, goal, set(), [])
```

### ì˜ˆìƒ ì¶œë ¥(ì„¤ëª…)

```diff
=== ë‹¨ìˆœ DFS ê²°ê³¼ ===
[ë‹¨ìˆœDFS] ê²½ë¡œ: [1, 2, 4]
# 4ê°€ ì´ë¯¸ visitedì´ë¯€ë¡œ [1, 3, 4]ëŠ” ì•ˆ ë‚˜ì˜´

=== ë°±íŠ¸ë˜í‚¹ DFS ê²°ê³¼ ===
[ë°±íŠ¸ë˜í‚¹] ê²½ë¡œ: [1, 2, 4]
[ë°±íŠ¸ë˜í‚¹] ê²½ë¡œ: [1, 3, 4]
```

------

## í•œ ì¤„ ìš”ì•½

- **ë°±íŠ¸ë˜í‚¹ = DFS + ìƒíƒœ ë˜ëŒë¦¬ê¸°**ë¡œ, **ë¶ˆê°€ëŠ¥/ë¹„ìœ ë§í•œ ë¶„ê¸° ì¦‰ì‹œ í¬ê¸°**í•˜ê³  **ê²½ë¡œë§ˆë‹¤ ë…ë¦½ì ì¸ ë°©ë¬¸ ìƒíƒœ**ë¥¼ ìœ ì§€í•´ **ëª¨ë“  í•´/ê²½ë¡œ**ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤.